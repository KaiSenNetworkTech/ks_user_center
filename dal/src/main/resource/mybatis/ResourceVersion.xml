<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yunos.tv.appupgrade.dal.dao.ResourceVersionDAO">

	<select id="getListByCondition" resultType="ResourceVersionDo" parameterType="ResourceUpgradeQuery">
		SELECT 
			`id`,`resource_id`,`version`,`version_name`,`release_note`,`status`,`download_path`,`download_md5`,`size`,`gmt_modify`,`extend`
		FROM `resource_version`
		WHERE 
			`resource_id` = #{resourceId} AND	
			<if test="version != null">	
			`version` > #{version}	AND
			</if>	
			<if test="statusList != null">
				 status IN 
				<foreach item="item" index="index" collection="statusList" open="(" separator="," close=")">
					#{item}
				</foreach>	
				AND	
			</if>	
			<if test="status != null">	 
				status = #{status} AND
			</if>	
			`is_delete` = 0
		ORDER BY `version` DESC	
		LIMIT 900
	</select>
	
	<select id="getById" resultType="ResourceVersionDo" parameterType="long">
		SELECT 
			`id`,`resource_id`,`version`,`version_name`,`release_note`,`status`,`download_path`,`download_md5`,`size`,`gmt_modify`
		FROM `resource_version`
		WHERE 
			`id` = #{id} AND	
			`is_delete` = 0
		LIMIT 1
	</select>
		
	<select id="getByResourceIdVersionName" resultType="ResourceVersionDo" parameterType="ResourceVersionDo">
		SELECT 
			`id`,`resource_id`,`version`,`version_name`,`release_note`,`status`,`download_path`,`download_md5`,`size`,`gmt_modify`
		FROM `resource_version`
		WHERE 
			`resource_id` = #{resourceId} AND		
			`version_name` = #{versionName} AND
			`is_delete` = 0
		ORDER BY `id` DESC	
		LIMIT 1
	</select>		

			
</mapper>