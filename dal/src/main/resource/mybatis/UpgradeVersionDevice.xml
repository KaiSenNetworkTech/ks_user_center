<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yunos.tv.appupgrade.dal.dao.UpgradeVersionDeviceDAO">

	<select id="selectById" resultType="UpgradeVersionDeviceDo" parameterType="long">
		SELECT 
			`id`,`version_id`,`model_id`,`minimum_os_version`,`highest_os_version`
		FROM `upg_version_device`
		WHERE id = #{id}
		LIMIT 1
	</select>

	<!--按版本ID\机型ID获取有效的机型规则表，从业务上看同一版本和机型取到的列表数据少于5条-->		
	<select id="getAllByCondition"  resultType="UpgradeVersionDeviceDo" parameterType="UpgradeVersionDeviceDo">
		SELECT 
			`id`,`version_id`,`model_id`,`minimum_os_version` mininumOsVersion,`highest_os_version` heghestOsVersion
		FROM
			`upg_version_device`
		WHERE
			<if test="versionIds != null">
				`version_id` IN 
				<foreach item="item" index="index" collection="versionIds" open="(" separator="," close=")">
					#{item}
				</foreach>
				AND 	
			</if>		
			<if test="versionId != null">	
			`version_id` = #{versionId} AND
			</if>
			<if test="modelId != null">		
			`model_id` = #{modelId} AND	
			</if>	
			`is_delete` = 0  
	</select>				

</mapper>